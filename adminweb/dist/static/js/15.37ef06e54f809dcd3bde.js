webpackJsonp([15],{"8C4o":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={name:"basetable",data:function(){return{tableData:[],cur_page:1,multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,editVisible:!1,resetVisible:!1,form:{name:"",role:"",phone:""},idx:-1,uid:"",pagenum:0,totalnum:0}},created:function(){this.getData()},computed:{},methods:{checkcarinfo:function(e){var t=this,a=this.tableData[e].id,l=this.tableData[e].openId;this.$axios.get("/ctb/user/wxgetCarList",{params:{openId:l,userId:a}}).then(function(a){1==a.data.code&&a.data.data.length>0&&null!=a.data.data[0].carNum&&(console.log(e+"次的获取车牌信息是："+a.data.data[0].carNum),t.tableData[e].carinfo=a.data.data[0].carNum)})},formatRole:function(e,t){return 0==e.role?"管理员":1==e.role?"运营":2==e.role?"用户":"未知"},handleCurrentChange:function(e){var t=this;this.pagenum=e-1,this.otableData="",setTimeout(function(){t.getData(t.jid)},300)},getData:function(){var e=this;this.$axios.get("/ctb/user/adminGetAllUsers",{params:{openId:"10000",userId:"4",page:this.pagenum,pageSize:15}}).then(function(t){1==t.data.code?e.tableData=t.data.data:e.$message.error(t.data.msg)}).then(function(t){for(var a=0;a<e.tableData.length;a++)e.checkcarinfo(a)})},search:function(){this.is_search=!0},handleEdit:function(e,t){this.idx=e;var a=this.tableData[e];this.form={name:a.name,phone:a.phone,trueName:a.trueName,address:a.address},this.editVisible=!0},handleblock:function(e,t){this.$message.error("封禁此用户吗")},handlecheck:function(e,t){this.$message.error("123")},saveEdit:function(e,t){var a=this,l=this.tableData[this.idx].id,o=this.tableData[this.idx].openId;this.$axios.get("/ctb/user/perfectUserInfo",{params:{openId:o,userId:l,phone:this.form.phone,trueName:this.form.trueName,address:this.form.address}}).then(function(e){console.log(e),1==e.data.code?(a.editVisible=!1,a.$message.success("用户信息修改成功"),a.form.name="",a.form.phone="",a.form.trueName="",a.form.address="",a.getData()):a.$message.error(e.data.msg)})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户管理")])],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"}),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"id号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"昵称",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"trueName",label:"姓名",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"130"}}),e._v(" "),a("el-table-column",{attrs:{prop:"role",label:"身份",formatter:e.formatRole,width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"地址",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"openId",label:"openid",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"unionid",label:"unionid",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"车辆信息",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("\n            "+e._s(t.row.carinfo)+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"230",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){e.handleblock(t.$index,t.row)}}},[e._v("封禁")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-check"},on:{click:function(a){e.handlecheck(t.$index,t.row)}}},[e._v("查看车辆")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.totalnum},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名"}},[a("el-input",{model:{value:e.form.trueName,callback:function(t){e.$set(e.form,"trueName",t)},expression:"form.trueName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址"}},[a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(l,o,!1,function(e){a("dxdV")},"data-v-0aac93cf",null);t.default=n.exports},dxdV:function(e,t){}});